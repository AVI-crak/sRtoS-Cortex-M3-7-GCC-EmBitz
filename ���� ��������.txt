Решил переписать свою ос с "С" на асму. Потому как GCC иногда настолько активно коверкает код - что он он начинает глючить в непредсказуемых местах.

Ос потоковая, уровни приоритета реализованы процентом выделенного кванта времени. Дополнительно - нить выполнившая всё что ей нужно - может самостоятельно уступить время.
Нити автономны, и могут влиять только на своё состояние.  

Запуск ос не требует модификаций проекта до третьего колена, просто подключить два файла в проект и всё.
Запуск кварцев и настройка PLL до майна !!! ну ли по крайней мере до старта ос.
Старт ос в любом месте майна.
Прерывания включение-выключение в любой работающей нити.
Код в прерываниях не поддерживает вызов функций, пишите компактно. !!!
В случае если размер под стек майна  указан меньше используемого на данный момент - размер корректируется.
В ситуации выхода стека за пределы - стоп в режиме отладки с переходом в зажравшуюся нить.
В режиме отладки мах задействованный размер стека сохраняется в нити.
Нити стартуют на первом свободном куске памяти сверху вниз.
При  удалении нити -место не чистится, но указатели на это место удаляются. 
Место под новую нить зануляется в размере (банк+загрузка задачи).

Задачу можно делать без бесконечного цикла !!!! Она тупо выполниться и самоустранится.

В процессе.



процент готовности 32% 

мыло для заинтересованных
videocrak@maol.ru
форум для обсуждения
http://forum.ixbt.com/topic.cgi?id=48:11735

репозиторий
https://bitbucket.org/AVI-crak/rtos-cortex-m3-gcc


http://www.youtube.com/watch?v=lGg5RqCE5Ig